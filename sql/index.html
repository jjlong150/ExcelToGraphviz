<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using SQL to Import Data from other Excel Spreadsheets | Excel to Graphviz</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/ExcelToGraphviz/favicon.ico">
    <meta name="description" content="--- home: true heroText: Excel to Graphviz heroImage: /exceltographiz.png tagline: See the relationships">
    
    <link rel="preload" href="/ExcelToGraphviz/assets/css/0.styles.7fca3c98.css" as="style"><link rel="preload" href="/ExcelToGraphviz/assets/js/app.f34868f6.js" as="script"><link rel="preload" href="/ExcelToGraphviz/assets/js/3.2d84c748.js" as="script"><link rel="preload" href="/ExcelToGraphviz/assets/js/8.b82bea55.js" as="script"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/10.3c13038a.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/11.99f0d37d.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/12.7e371493.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/13.382a7f34.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/14.153dbf60.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/15.7e8102b2.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/16.c108052a.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/2.6ccbb39c.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/4.d805d59d.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/5.8412ee0e.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/6.31c09bba.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/7.15df5032.js"><link rel="prefetch" href="/ExcelToGraphviz/assets/js/9.5c18d7a5.js">
    <link rel="stylesheet" href="/ExcelToGraphviz/assets/css/0.styles.7fca3c98.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ExcelToGraphviz/" class="home-link router-link-active"><img src="/ExcelToGraphviz/hero.png" alt="Excel to Graphviz" class="logo"> <span class="site-name can-hide">Excel to Graphviz</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ExcelToGraphviz/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/ExcelToGraphviz/install-win/" class="nav-link">
  Installallation
</a></div><div class="nav-item"><a href="/ExcelToGraphviz/terminology/" class="nav-link">
  Terminology
</a></div><div class="nav-item"><a href="/ExcelToGraphviz/thirdparty/" class="nav-link">
  Notices
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ExcelToGraphviz/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/ExcelToGraphviz/install-win/" class="nav-link">
  Installallation
</a></div><div class="nav-item"><a href="/ExcelToGraphviz/terminology/" class="nav-link">
  Terminology
</a></div><div class="nav-item"><a href="/ExcelToGraphviz/thirdparty/" class="nav-link">
  Notices
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Using SQL to Import Data from other Excel Spreadsheets</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ExcelToGraphviz/sql/#sql-explained" class="sidebar-link">SQL Explained</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/ExcelToGraphviz/sql/#activex-data-objects-ado-sql-queries" class="sidebar-link">ActiveX Data Objects (ADO) SQL Queries</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/ExcelToGraphviz/sql/#sql-ribbon-controls" class="sidebar-link">SQL Ribbon Controls</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ExcelToGraphviz/sql/#sql" class="sidebar-link">SQL</a></li><li class="sidebar-sub-header"><a href="/ExcelToGraphviz/sql/#visualize" class="sidebar-link">Visualize</a></li></ul></li><li><a href="/ExcelToGraphviz/sql/#writing-sql-queries-to-create-graphs" class="sidebar-link">Writing SQL Queries to create graphs</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/ExcelToGraphviz/sql/#for-more-information-on-excel-sql" class="sidebar-link">For more information on Excel SQL</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="using-sql-to-import-data-from-other-excel-spreadsheets"><a href="#using-sql-to-import-data-from-other-excel-spreadsheets" class="header-anchor">#</a> Using SQL to Import Data from other Excel Spreadsheets</h1> <p>Have you ever wished that you could graph data that resides in some other spreadsheet? Do you have spreadsheets which change frequently, and thus need frequent re-graphing? The Relationship Visualizer provides a powerful solution which lets you write Structured Query Language (SQL) statements which can pull in your data from other worksheets in an easily repeatable manner.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Using the SQL capability is optional. You do not have to use this feature to create graphs. This is a feature for the Relationship Visualizer power user and requires some working knowledge of how to write SQL statements.</p></div> <h2 id="sql-explained"><a href="#sql-explained" class="header-anchor">#</a> SQL Explained</h2> <p>Structured Query Language (SQL) is a domain-specific language designed for stream processing in a relational data stream management system (RDSMS). It is particularly useful in handling structured data where there are relations between different entities/variables of the data.</p> <p>SQL <code>SELECT</code> statements are designed for a specific purpose: to query data contained in a relational database. The SQL <code>SELECT</code> statement selects data from a database, specifying column(s) headings, table(s) from which columns are to be selected, and the criteria for selection. <code>SELECT \*</code> is used to select all columns from a table. The <code>FROM</code> clause in a <code>SELECT</code> statement specifies the Table from which columns are to be selected. The <code>WHERE</code> clause in a SELECT statement specifies the criteria for selection.</p> <p>Syntax: <code>SELECT column_name FROM table_name [WHERE clause]</code></p> <h2 id="activex-data-objects-ado-sql-queries"><a href="#activex-data-objects-ado-sql-queries" class="header-anchor">#</a> ActiveX Data Objects (ADO) SQL Queries</h2> <p>Excel can function as a flat-file RDBMS database that can be accessed using ActiveX Data Objects (ADO) and SQL queries. Microsoft Excel handles SQL via its own SQL dialect. See the references at the end of this chapter for detailed information on the Excel SQL dialect.</p> <p>The Relationship Visualizer contains a worksheet named 'sql' which hides most of the complexities of writing ADO SQL. It allows you to write SQL <code>SELECT</code> queries conforming to the ADO syntax conventions and it takes care of the rest. The SQL <code>SELECT</code> statements can reference either the Relationship Visualizer spreadsheet or another Excel spreadsheet as the source of the data. When the query is executed, the query results are written to the 'data' worksheet ready for graphing.</p> <p>ADO has many features, but the only features which the Relationship Visualizer uses are SQL <code>SELECT</code> queries of the form:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span> <span class="token punctuation">[</span>Country Code<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token punctuation">[</span>Country Name<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Label<span class="token punctuation">]</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">[</span>Countries\$<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This is a standard SQL query, one that selects two columns in the database (which in our case is a worksheet) and names the results to correspond to the column names of the 'data' worksheet. Notice that we specify the name of an individual worksheet in the query, in the same way that we would specify an individual table name if we were connecting to a database, with a couple of minor exceptions. The worksheet name is enclosed in square brackets and that the actual worksheet name - <strong>Countries</strong> - has a <strong>$</strong> appended to it.</p> <p>Square brackets are also used to wrap the column names since the column names may have spaces present. The square brackets inform ADO to treat the value inside as the column name. Square brackets are used instead of quotes because quotes denote a string value to place in the results.</p> <p>The results of the <code>SELECT</code> statements are processed by the Relationship Visualizer to place the selected values into the appropriate columns of the 'data' worksheet. The processing logic only recognizes the column names, and will discard all other data. The default English column names on the <code>data</code> worksheet are:</p> <ul><li>[Comment]</li> <li>[Item]</li> <li>[Label]</li> <li>[External Label]</li> <li>[Tail Label]</li> <li>[Head Label]</li> <li>[Related Item]</li> <li>[Style Name]</li> <li>[Attributes]</li></ul> <p>Excel SQL also allows you to specify strings values as selection columns. The string is repeated for each row of the query results when the SQL is executed. This is a useful feature for specifying values such as a style name.</p> <p>Assume that there is a style defined on the <code>styles</code> worksheet named &quot;Country&quot;. The query is modified as follows to add a style named &quot;Country&quot; to each row of the results:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span> <span class="token punctuation">[</span>Country Code<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token punctuation">[</span>Country Name<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Label<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token string">'Country'</span>      <span class="token keyword">as</span> <span class="token punctuation">[</span>Style Name<span class="token punctuation">]</span>
    <span class="token keyword">FROM</span>   <span class="token punctuation">[</span>Countries\$<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>SQL allows you to specify <code>WHERE</code> conditions which control what information is returned. The <code>WHERE</code> clause, states the qualifying conditions for a query. Multiple conditions can be joined by the <code>AND</code> and <code>OR</code> clauses, optionally surrounded by (parentheses) to group them. Only the records that satisfy the specified criteria are returned by the query.</p> <p>Assume that we wanted a list of countries which use US Dollars as their national currency. The international code for US Dollars is &quot;USD&quot; so the SQL would be modified to appear as follows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span> <span class="token punctuation">[</span>Country Code<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token punctuation">[</span>Country Name<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Label<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token string">'Country'</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Style Name<span class="token punctuation">]</span>
    <span class="token keyword">FROM</span>   <span class="token punctuation">[</span>Countries\$<span class="token punctuation">]</span>
    <span class="token keyword">WHERE</span>  <span class="token punctuation">[</span>Currency Code<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'USD'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>A column often contains duplicate values. To list the distinct values, use the <code>SELECT DISTINCT</code> clause. The <code>DISTINCT</code> keyword can be used to return only unique values from a set of records. For example, if our worksheet contains the continent names where countries reside, we can obtain a list of the continents without duplicate rows using the following SQL statement:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span>          <span class="token keyword">as</span> <span class="token punctuation">[</span>Label<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token string">'Continent'</span>          <span class="token keyword">as</span> <span class="token punctuation">[</span>Style Name<span class="token punctuation">]</span>
    <span class="token keyword">FROM</span>   <span class="token punctuation">[</span>Countries\$<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Now that you understand the basics of writing SQL SELECT statements, let us look at the features contained in the 'sql' worksheet and ribbon tab.</p> <p>The 'sql' worksheet is hidden by default. To expose the 'sql' worksheet select the 'sql' button on the <code>Graphviz</code> tab.</p> <p><img src="data:image/png;base64,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" alt=""></p> <h2 id="sql-ribbon-controls"><a href="#sql-ribbon-controls" class="header-anchor">#</a> SQL Ribbon Controls</h2> <p>The 'SQL ribbon tab is activated whenever the 'sql' worksheet is activated. It appears as follows:</p> <p><img src="/ExcelToGraphviz/assets/img/9dfc9427e1707656d96f800c25ee1885.9dfc9427.png" alt=""></p> <p>It contains the following major groups:</p> <ul><li>SQL</li> <li>Visualize</li></ul> <h3 id="sql"><a href="#sql" class="header-anchor">#</a> SQL</h3> <p><img src="data:image/png;base64,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" alt=""></p> <table><thead><tr><th>Label</th> <th>Control Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Run SQL Commands</td> <td>Button</td> <td>Sequentially runs the SQL statements in this worksheet, writing the results to the 'data' worksheet.</td></tr> <tr><td>Clear Status</td> <td>Button</td> <td>Clear the values from the 'Status' column.</td></tr></tbody></table> <h3 id="visualize"><a href="#visualize" class="header-anchor">#</a> Visualize</h3> <p><img src="data:image/png;base64,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" alt=""></p> <table><thead><tr><th>Label</th> <th>Control Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Refresh Graph</td> <td>Button</td> <td>Graphs the data in the 'data' worksheet and displays the results in Excel. This button does the same work as the like-named button on the <code>Graphviz</code> ribbon tab and is included here to speed the creation of graphs after running SQL statements.</td></tr> <tr><td>Graph to File</td> <td>Button</td> <td>Graphs the data in the 'data' worksheet and writes the graph to a file using the values specified on the Graphviz ribbon tab. This button does the same work as the like-named button on the <code>Graphviz</code> ribbon tab and is included here to speed the creation of graphs after running SQL statements.</td></tr> <tr><td>All views to File</td> <td>Button</td> <td>Graphs the data in the 'data' worksheet against all the views specified and writes the graphs to files using the values specified on the Graphviz ribbon tab. This button does the same work as the like-named button on the <code>Graphviz</code> ribbon tab and is included here to speed the creation of graphs after running SQL statements.</td></tr></tbody></table> <h2 id="writing-sql-queries-to-create-graphs"><a href="#writing-sql-queries-to-create-graphs" class="header-anchor">#</a> Writing SQL Queries to create graphs</h2> <p>In the Relationship Visualizer download zip file, there is a directory named &quot;SQL - World Map&quot; within the &quot;samples&quot; directory. We will use this example to show how to use the 'sql' worksheet. The &quot;SQL - World Map&quot; directory has in it a copy of the Relationship Visualizer spreadsheet containing SQL statements, and predefined styles on the 'styles' worksheet, as well as 'data' directory which has 5 representations of a &quot;countries&quot; worksheet corresponding to the supported file extensions of csv, xls, xlsb, xlsm, and xslx. All of the &quot;countries&quot; spreadsheets have the same data. The query logic has to treat each file extension a little differently (I won't bore you with the details) and is included in the different formats simply for testing purposes. An example of a &quot;countries&quot; workbook appears as follows:</p> <p><img src="/ExcelToGraphviz/assets/img/635d4bbb6c94a64856ea7ab380a10452.635d4bbb.png" alt=""></p> <p>Now open the file &quot;Relationship Visualizer.xslm&quot;, select the 'sql' worksheet. Note that there are 4 rows with SQL statements. We will use these statements to extract the values out the 'countries' workbooks and draw a graph view of the continents, countries, and connected borders. The 'sql' worksheet appears as follows:</p> <p><img src="/ExcelToGraphviz/assets/img/d7e700f6a29de2275aeca07e492aca20.d7e700f6.png" alt=""></p> <p>The first SQL statement on row 2 selects the column &quot;ISO&quot; to represent the Item ID, as well as the node label. The country name is selected to be an External Label, and the continent name is selected to be the style name. Within the 'styles' worksheet there are 7 node style definitions which correspond to the continent names.</p> <p>The SQL is written as follows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">[</span>ISO<span class="token punctuation">]</span>       <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span>ISO<span class="token punctuation">]</span>       <span class="token keyword">as</span> <span class="token punctuation">[</span>Label<span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span>Country<span class="token punctuation">]</span>   <span class="token keyword">as</span> <span class="token punctuation">[</span>External Label<span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Style Name<span class="token punctuation">]</span>
<span class="token keyword">FROM</span>  <span class="token punctuation">[</span>countries\$<span class="token punctuation">]</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>ISO<span class="token punctuation">]</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span>Country<span class="token punctuation">]</span> <span class="token keyword">ASC</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The second SQL statement on row 3 will extract the 7 seven unique continent names from the list of countries by using the DISTINCT clause. The continent name will be used as the Item ID as well as the node label. A style name of &quot;Continent&quot; will be used for all the rows.</p> <p>The SQL is written as follows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Label<span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">'Continent'</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Style Name<span class="token punctuation">]</span>
<span class="token keyword">FROM</span> <span class="token punctuation">[</span>countries\$<span class="token punctuation">]</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The third SQL statement on row 4 creates edge relationship rows by selecting the ISO value as the Item ID, and the &quot;Neighbors&quot; column as the <code>Related Item</code> value. The &quot;Neighbors&quot; column in the source worksheet contains comma-delimited ISO values which are neighboring countries to that row. The Relationship Visualizer has built-in logic to expand the comma-delimited list into multiple relationships. No style name is provided, so the default edge style will be used. Note that on the WHERE clause the directive &quot;IS NOT NULL&quot; has been added. This clause causes the query to skip rows with empty cells, as there are no values with which to express relationships.</p> <p>The SQL is written as follows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">[</span>ISO<span class="token punctuation">]</span>       <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span>Neighbors<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Related Item<span class="token punctuation">]</span>
<span class="token keyword">FROM</span>   <span class="token punctuation">[</span>countries\$<span class="token punctuation">]</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>Neighbors<span class="token punctuation">]</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The fourth SQL statement on row 5 is used to group countries by continent. It creates edge relationships by placing the Continent name as the Item ID, and the ISO country code in the <code>Related Item</code> column. The style name is specified as &quot;ContinentToCountry&quot;.</p> <p>The SQL is written as follows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">[</span>Continent<span class="token punctuation">]</span>          <span class="token keyword">as</span> <span class="token punctuation">[</span>Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span>ISO<span class="token punctuation">]</span>                <span class="token keyword">as</span> <span class="token punctuation">[</span>Related Item<span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token string">'ContinentToCountry'</span> <span class="token keyword">as</span> <span class="token punctuation">[</span>Style Name<span class="token punctuation">]</span>
<span class="token keyword">FROM</span> <span class="token punctuation">[</span>countries\$<span class="token punctuation">]</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>ISO<span class="token punctuation">]</span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Each of these queries have to specify the name of the workbook against which the SQL is to run. This information is contained in column C. There are three ways the file name may be specified.</p> <ol><li>Specify the full path to the file as shown in the sample file.</li> <li>Specify just the file name. The Relationship Visualizer will assume that the data workbook is contained in the same directory as the Relationship Visualizer workbook.</li> <li>Leave the cell blank. If the cell is blank the Relationship Visualizer assumes that the data is contained within the current Relationship Visualizer workbook.</li></ol> <p>Once the file paths are specified, we can run the SQL. Press the &quot;Run SQL Commands&quot; button</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>The SQL commands are run in sequence from top to bottom. Results are written to the 'data' worksheet, and the query result status is displayed in column D such as:</p> <p><img src="/ExcelToGraphviz/assets/img/b4bf922b0e12d5a322475f6f836209a6.b4bf922b.png" alt=""></p> <p>If we switch worksheets to the 'data' worksheet, it appears as follows:</p> <p><img src="/ExcelToGraphviz/assets/img/8c4309d1efcbddd71daadb0c1dd3d9dd.8c4309d1.png" alt=""></p> <p>The data is all present and in the appropriate columns for graphing. In this example 678 rows of data have been created using 4 SQL statements! Press the <code>Refresh Graph</code> button to graph the data. Since this is a large data set, be prepared to wait a little while for the results.</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>When Graphviz completes its work, you should see a logical world graph which appears as follows (sent to 'graph' worksheet with zoom level set to 30%):</p> <p><img src="/ExcelToGraphviz/assets/img/1fb5513a83b5269775e982f1ea98b7cc.1fb5513a.png" alt=""></p> <h2 id="for-more-information-on-excel-sql"><a href="#for-more-information-on-excel-sql" class="header-anchor">#</a> For more information on Excel SQL</h2> <ul><li>Writing SQL Queries against Excel files (Excel SQL) - <a href="https://querysurge.zendesk.com/hc/en-us/articles/205766136-Writing-SQL-Queries-against-Excel-files" target="_blank" rel="noopener noreferrer">https://querysurge.zendesk.com/hc/en-us/articles/205766136-Writing-SQL-Queries-against-Excel-files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>SQL Query Reference - <a href="https://www.aquaclusters.com/app/home/project/public/aquadatastudio/wikibook/MS-Excel/page/SQL-Query-Reference/SQL-Query-Reference" target="_blank" rel="noopener noreferrer">https://www.aquaclusters.com/app/home/project/public/aquadatastudio/wikibook/MS-Excel/page/SQL-Query-Reference/SQL-Query-Reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Fundamental Microsoft Jet SQL for Access 2000 - <a href="https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa140011%28v%3doffice.10%29" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa140011(v%3Doffice.10)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Intermediate Microsoft Jet SQL for Access 2000 - <a href="https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa140015%28v%3doffice.10%29" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa140015(v%3Doffice.10)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/ExcelToGraphviz/assets/js/app.f34868f6.js" defer></script><script src="/ExcelToGraphviz/assets/js/3.2d84c748.js" defer></script><script src="/ExcelToGraphviz/assets/js/8.b82bea55.js" defer></script>
  </body>
</html>
