<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using SQL - Organization Charts | Excel to Graphviz</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="--- home: true heroText: Excel to Graphviz heroImage: /exceltographiz.png tagline: See the relationships">
    
    <link rel="preload" href="/assets/css/0.styles.b2d5fed3.css" as="style"><link rel="preload" href="/assets/js/app.5b85367f.js" as="script"><link rel="preload" href="/assets/js/6.56d8a82c.js" as="script"><link rel="preload" href="/assets/js/12.d313ae13.js" as="script"><link rel="prefetch" href="/assets/js/10.4befe2c4.js"><link rel="prefetch" href="/assets/js/11.9f2464f7.js"><link rel="prefetch" href="/assets/js/13.5b743e3e.js"><link rel="prefetch" href="/assets/js/14.3b93dd6d.js"><link rel="prefetch" href="/assets/js/15.a254506c.js"><link rel="prefetch" href="/assets/js/16.581febbf.js"><link rel="prefetch" href="/assets/js/17.e8d831ec.js"><link rel="prefetch" href="/assets/js/18.ffc57686.js"><link rel="prefetch" href="/assets/js/19.7e7fe1ac.js"><link rel="prefetch" href="/assets/js/2.081c05db.js"><link rel="prefetch" href="/assets/js/20.c8be0170.js"><link rel="prefetch" href="/assets/js/21.02f5b5dd.js"><link rel="prefetch" href="/assets/js/22.112b2da7.js"><link rel="prefetch" href="/assets/js/23.392ae7dd.js"><link rel="prefetch" href="/assets/js/24.0b3b074d.js"><link rel="prefetch" href="/assets/js/25.ac0b327e.js"><link rel="prefetch" href="/assets/js/26.869de342.js"><link rel="prefetch" href="/assets/js/27.cb407ca2.js"><link rel="prefetch" href="/assets/js/28.e19791da.js"><link rel="prefetch" href="/assets/js/29.58ad6bf5.js"><link rel="prefetch" href="/assets/js/3.b12ba3cb.js"><link rel="prefetch" href="/assets/js/30.b21e09c2.js"><link rel="prefetch" href="/assets/js/31.b5b202c8.js"><link rel="prefetch" href="/assets/js/32.e6c76160.js"><link rel="prefetch" href="/assets/js/33.1ffd9b3b.js"><link rel="prefetch" href="/assets/js/34.ca498420.js"><link rel="prefetch" href="/assets/js/35.267d5a44.js"><link rel="prefetch" href="/assets/js/36.cac1d4dc.js"><link rel="prefetch" href="/assets/js/37.5136fc19.js"><link rel="prefetch" href="/assets/js/4.215cdd1a.js"><link rel="prefetch" href="/assets/js/5.34322999.js"><link rel="prefetch" href="/assets/js/7.cacf3e88.js"><link rel="prefetch" href="/assets/js/8.9b2d340e.js"><link rel="prefetch" href="/assets/js/9.ced35a4e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b2d5fed3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Excel to Graphviz" class="logo"> <span class="site-name can-hide">Excel to Graphviz</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Download" class="dropdown-title"><span class="title">Download</span> <span class="arrow down"></span></button> <button type="button" aria-label="Download" class="mobile-dropdown-title"><span class="title">Download</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://graphviz.org/download/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  - Graphviz
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://sourceforge.net/projects/relationship-visualizer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  - Relationship Visualizer
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Install" class="dropdown-title"><span class="title">Install</span> <span class="arrow down"></span></button> <button type="button" aria-label="Install" class="mobile-dropdown-title"><span class="title">Install</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/install-win/" class="nav-link">
  - Microsoft Windows
</a></li><li class="dropdown-item"><!----> <a href="/install-mac/" class="nav-link">
  - macOS
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Worksheets" class="dropdown-title"><span class="title">Worksheets</span> <span class="arrow down"></span></button> <button type="button" aria-label="Worksheets" class="mobile-dropdown-title"><span class="title">Worksheets</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Data
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/create/#the-data-worksheet" class="nav-link">
  - data
</a></li><li class="dropdown-subitem"><a href="/create/#graph-to-worksheet" class="nav-link">
  - graph
</a></li></ul></li><li class="dropdown-item"><h4>
          Style
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tutorial/#the-style-designer-ribbon-tab" class="nav-link">
  - style designer
</a></li><li class="dropdown-subitem"><a href="/styles/" class="nav-link">
  - styles
</a></li></ul></li><li class="dropdown-item"><h4>
          Data Exchange
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/sql/" class="nav-link router-link-active">
  - sql
</a></li><li class="dropdown-subitem"><a href="/exchange/" class="nav-link">
  - json
</a></li></ul></li><li class="dropdown-item"><h4>
          Post-processing
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/svg/" class="nav-link">
  - svg
</a></li></ul></li><li class="dropdown-item"><h4>
          Graphviz dot
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/source/" class="nav-link">
  - source
</a></li><li class="dropdown-subitem"><a href="/console/" class="nav-link">
  - console
</a></li><li class="dropdown-subitem"><a href="/workbook/#help-attributes-worksheet" class="nav-link">
  - attributes
</a></li><li class="dropdown-subitem"><a href="/workbook/#help-colors-worksheet" class="nav-link">
  - colors
</a></li><li class="dropdown-subitem"><a href="/workbook/#help-shapes-worksheet" class="nav-link">
  - shapes
</a></li></ul></li><li class="dropdown-item"><h4>
          Maintenance
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/diagnostics/" class="nav-link">
  - diagnostics
</a></li><li class="dropdown-subitem"><a href="/lists/" class="nav-link">
  - lists
</a></li><li class="dropdown-subitem"><a href="/settings/" class="nav-link">
  - settings
</a></li></ul></li><li class="dropdown-item"><h4>
          Information
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/info/" class="nav-link">
  - info
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About..." class="dropdown-title"><span class="title">About...</span> <span class="arrow down"></span></button> <button type="button" aria-label="About..." class="mobile-dropdown-title"><span class="title">About...</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">
  - About Excel to Graphviz
</a></li><li class="dropdown-item"><!----> <a href="/acknowledge/" class="nav-link">
  - Acknowledgements
</a></li><li class="dropdown-item"><!----> <a href="https://buymeacoffee.com/exceltographviz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  - Donate ☕
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Download" class="dropdown-title"><span class="title">Download</span> <span class="arrow down"></span></button> <button type="button" aria-label="Download" class="mobile-dropdown-title"><span class="title">Download</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://graphviz.org/download/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  - Graphviz
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://sourceforge.net/projects/relationship-visualizer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  - Relationship Visualizer
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Install" class="dropdown-title"><span class="title">Install</span> <span class="arrow down"></span></button> <button type="button" aria-label="Install" class="mobile-dropdown-title"><span class="title">Install</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/install-win/" class="nav-link">
  - Microsoft Windows
</a></li><li class="dropdown-item"><!----> <a href="/install-mac/" class="nav-link">
  - macOS
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Worksheets" class="dropdown-title"><span class="title">Worksheets</span> <span class="arrow down"></span></button> <button type="button" aria-label="Worksheets" class="mobile-dropdown-title"><span class="title">Worksheets</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Data
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/create/#the-data-worksheet" class="nav-link">
  - data
</a></li><li class="dropdown-subitem"><a href="/create/#graph-to-worksheet" class="nav-link">
  - graph
</a></li></ul></li><li class="dropdown-item"><h4>
          Style
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tutorial/#the-style-designer-ribbon-tab" class="nav-link">
  - style designer
</a></li><li class="dropdown-subitem"><a href="/styles/" class="nav-link">
  - styles
</a></li></ul></li><li class="dropdown-item"><h4>
          Data Exchange
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/sql/" class="nav-link router-link-active">
  - sql
</a></li><li class="dropdown-subitem"><a href="/exchange/" class="nav-link">
  - json
</a></li></ul></li><li class="dropdown-item"><h4>
          Post-processing
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/svg/" class="nav-link">
  - svg
</a></li></ul></li><li class="dropdown-item"><h4>
          Graphviz dot
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/source/" class="nav-link">
  - source
</a></li><li class="dropdown-subitem"><a href="/console/" class="nav-link">
  - console
</a></li><li class="dropdown-subitem"><a href="/workbook/#help-attributes-worksheet" class="nav-link">
  - attributes
</a></li><li class="dropdown-subitem"><a href="/workbook/#help-colors-worksheet" class="nav-link">
  - colors
</a></li><li class="dropdown-subitem"><a href="/workbook/#help-shapes-worksheet" class="nav-link">
  - shapes
</a></li></ul></li><li class="dropdown-item"><h4>
          Maintenance
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/diagnostics/" class="nav-link">
  - diagnostics
</a></li><li class="dropdown-subitem"><a href="/lists/" class="nav-link">
  - lists
</a></li><li class="dropdown-subitem"><a href="/settings/" class="nav-link">
  - settings
</a></li></ul></li><li class="dropdown-item"><h4>
          Information
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/info/" class="nav-link">
  - info
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About..." class="dropdown-title"><span class="title">About...</span> <span class="arrow down"></span></button> <button type="button" aria-label="About..." class="mobile-dropdown-title"><span class="title">About...</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">
  - About Excel to Graphviz
</a></li><li class="dropdown-item"><!----> <a href="/acknowledge/" class="nav-link">
  - Acknowledgements
</a></li><li class="dropdown-item"><!----> <a href="https://buymeacoffee.com/exceltographviz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  - Donate ☕
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Using SQL - Organization Charts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/orgcharts/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sql/orgcharts/#scenario" class="sidebar-link">Scenario</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sql/orgcharts/#standard-query" class="sidebar-link">Standard Query</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sql/orgcharts/#tree-query" class="sidebar-link">Tree Query</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql/orgcharts/#max-depth" class="sidebar-link">Max Depth</a></li><li class="sidebar-sub-header"><a href="/sql/orgcharts/#where-value" class="sidebar-link">Where Value</a></li></ul></li><li><a href="/sql/orgcharts/#styling-the-nodes" class="sidebar-link">Styling the Nodes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql/orgcharts/#named-styles" class="sidebar-link">Named Styles</a></li><li class="sidebar-sub-header"><a href="/sql/orgcharts/#label-text-format" class="sidebar-link">Label Text Format</a></li><li class="sidebar-sub-header"><a href="/sql/orgcharts/#label-line-splits" class="sidebar-link">Label Line Splits</a></li></ul></li><li><a href="/sql/orgcharts/#writing-the-node-query" class="sidebar-link">Writing the Node Query</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql/orgcharts/#combining-the-edges-and-nodes" class="sidebar-link">Combining the Edges and Nodes</a></li></ul></li><li><a href="/sql/orgcharts/#sample-content" class="sidebar-link">Sample Content</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="using-sql-organization-charts"><a href="#using-sql-organization-charts" class="header-anchor">#</a> Using SQL - Organization Charts</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p><em>Relationship Visualizer</em> Version 7.2 added support for recursive SQL queries, enabling the creation of hierarchies such as organization charts.</p> <p>The candidate dataset should include the following key columns which define relationships, allowing hierarchical traversal.</p> <ul><li>A parent node.</li> <li>A child node.</li></ul> <p>A recursive query consists of 2 parts:</p> <ol><li><em>Anchor the Base Case</em>: Define the starting point for recursion (e.g., the top-level parent in the hierarchy, like the CEO).</li> <li><em>Define the Recursive Member</em>: Specify how to recursively join results back to the table to construct subsequent levels.</li></ol> <p>Four new keywords have been defined to enable recursive queries:</p> <ul><li><p><code>TREE QUERY</code> - Passed as a literal string, the presence of <code>TREE QUERY</code> in the SQL result set tells the SQL engine to execute the associated SQL recursively.</p> <p>The SQL <strong>must</strong> contain the symbolic value <code>''{WHERE VALUE}''</code> which will be replaced as each node is traversed with the value of the current node.</p> <p>Note that since <code>TREE QUERY</code> is passed as a literal string, any strings in the SQL which would normally be specified with <code>'</code> delimiters must be escaped as <code>''</code>.</p></li> <li><p><code>WHERE VALUE</code> provides the value which anchors the base case. For example, in an organization chart it could be the ID of the CEO. For a subway line, it could be the starting subway station.</p></li> <li><p><code>WHERE COLUMN</code> - Specifies the name of the column which defines the recursive member. It is the name of the column containing the value which should be searched next. For example, in an organization chart it could be column name of the column containing the ID of the employee's manager.</p></li> <li><p><code>MAX DEPTH</code> - Specifies an <strong>optional</strong> integer value which specifies the maximum number of branches preceding, or following the node specified by <code>WHERE VALUE</code>. For example, <code>3 AS [MAX DEPTH]</code> says to constrain the search to 3 edge ranks which follow a node , or 3 edge ranks which precede a node , depending upon the direction of the search.</p></li></ul> <h2 id="scenario"><a href="#scenario" class="header-anchor">#</a> Scenario</h2> <p>You want to create an organization chart of the Executive Branch of the the United States government. (No politics intended, AI was used to create a sample data set).</p> <p>Assume you have an Excel workbook with a worksheet named <code>US Executive Branch</code> containing information such as Name, Title, Department, and who reports to who. The data appears as:</p> <p><img src="/assets/img/SampleData.ff6e75f0.png" alt=""></p> <h2 id="standard-query"><a href="#standard-query" class="header-anchor">#</a> Standard Query</h2> <p>The traditional way to graph this data was to use a query such as:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">[</span>Reports <span class="token keyword">To</span> ID<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>ITEM<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">[</span>ID<span class="token punctuation">]</span>        <span class="token keyword">AS</span> <span class="token punctuation">[</span>RELATED ITEM<span class="token punctuation">]</span><span class="token punctuation">,</span> 
       <span class="token punctuation">[</span>Department<span class="token punctuation">]</span>    <span class="token keyword">AS</span> <span class="token punctuation">[</span>CLUSTER<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Border 2 '</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>CLUSTER STYLE NAME<span class="token punctuation">]</span>
<span class="token keyword">FROM</span>   <span class="token punctuation">[</span>US Executive Branch$<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>which relates the <code>Reports To ID</code> to the <code>ID</code>, and clusters the nodes by Department, using the <code>Border 2</code> style on the <code>styles</code> worksheet.</p> <p>Running the SQL produces the following (undirected) graph:</p> <p><img src="/assets/img/Example01.ae9f2649.png" alt=""></p> <p>The issue with this approach is that it graphs the entire organization. For instance, if you only want to graph the department heads, there isn't a specific column in the data to filter by.</p> <h2 id="tree-query"><a href="#tree-query" class="header-anchor">#</a> Tree Query</h2> <h3 id="max-depth"><a href="#max-depth" class="header-anchor">#</a> Max Depth</h3> <p>A tree query which specifies a <code>Max Depth</code> will allow us to extract just the department heads from the full organization.</p> <p>We write the Tree Query as follows:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
  <span class="token string">'SELECT [ID], [Reports To ID] AS [ITEM],    [ID] AS [RELATED ITEM], 
                [Department]    AS [CLUSTER], ''Border 2 '' AS [CLUSTER STYLE NAME]
          FROM [US Executive Branch$] WHERE [Reports To ID] = ''{WHERE VALUE}'''</span> 
       <span class="token keyword">AS</span> <span class="token punctuation">[</span>TREE QUERY<span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token string">'1'</span>  <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">VALUE</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token string">'ID'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">COLUMN</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">1</span>    <span class="token keyword">AS</span> <span class="token punctuation">[</span>MAX DEPTH<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="where-value"><a href="#where-value" class="header-anchor">#</a> Where Value</h3> <p>In  this query we are using <code>ID = 1</code> (<em>President of the United States</em>), and a <code>Max Depth = 1</code>. The graph changes to:</p> <p><img src="/assets/img/Example02-1-1.08372218.png" alt=""></p> <p>If we change the <code>Max Depth</code> to <code>2</code>, the graph changes to:</p> <p><img src="/assets/img/Example02-1-2.3f76173b.png" alt=""></p> <p>Likewise we can choose the <code>ID</code> of department head and obtain the organzation chart for a single department. <code>15</code> is the <code>ID</code> for the head of the <em>Department of the Interior</em>. If we change the <code>WHERE VALUE</code> in query to <code>15</code>, and <code>MAX DEPTH</code> to <code>2</code>, the query becomes:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
  <span class="token string">'SELECT [ID], [Reports To ID] AS [ITEM],    [ID] AS [RELATED ITEM], 
                [Department]    AS [CLUSTER], ''Border 2 '' AS [CLUSTER STYLE NAME]
          FROM [US Executive Branch$] WHERE [Reports To ID] = ''{WHERE VALUE}'''</span> 
       <span class="token keyword">AS</span> <span class="token punctuation">[</span>TREE QUERY<span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token string">'15'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">VALUE</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token string">'ID'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">COLUMN</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">2</span>    <span class="token keyword">AS</span> <span class="token punctuation">[</span>MAX DEPTH<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>and the graph changes to:</p> <p><img src="data:image/png;base64,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" alt=""></p> <h2 id="styling-the-nodes"><a href="#styling-the-nodes" class="header-anchor">#</a> Styling the Nodes</h2> <h3 id="named-styles"><a href="#named-styles" class="header-anchor">#</a> Named Styles</h3> <p>The tree structure has been determined, now we want to create styled nodes with department detail.</p> <p>The first step is to create a style definition on the <code>styles</code> worksheet. We use the <code>style designer</code> tab to create a style named <code>Department</code> which appears as follows:</p> <p><img src="data:image/png;base64,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" alt=""></p> <h3 id="label-text-format"><a href="#label-text-format" class="header-anchor">#</a> Label Text Format</h3> <p>We would also like the name of the department head to appear in bold text, and the job title to appear as normal text on its own line, separated by a blank line. Graphviz supports HTML-like labels which can be used. The HTML-like label needs to follow the pattern</p> <p><code>&lt;&lt;b&gt;Name&lt;/b&gt;&lt;BR/&gt;&lt;BR/&gt;Title&gt;</code></p> <p>for example:</p> <p><code>&lt;&lt;b&gt;Deb Haaland&lt;/b&gt;&lt;BR/&gt;&lt;BR/&gt;Secretary of the Interior&gt;</code></p> <h3 id="label-line-splits"><a href="#label-line-splits" class="header-anchor">#</a> Label Line Splits</h3> <p>We are also concerned about the length of the names or titles being larger than the width of the rectangle we have defined. The Relationship Visualizer SQL interpreter has features which allow you to split text at the nearest blank character after a specified length, and a feature to allow you to specify a string at the point the the split.</p> <p>In the SQL we can specify</p> <ul><li><p><code>'25' AS [SPLIT LENGTH]</code> to split each line in the label as close as possible to the 25th position</p></li> <li><p><code>'&lt;BR/&gt;' [AS LINE ENDING]</code> as the line ending of each break in the string. The label is HTML-like, so we use an HTML break representation <code>&lt;BR/&gt;</code>.</p> <p><strong>FYI</strong>, if we were using plain-text labels the line ending choices would be <code>\l</code> for left justied breaks, <code>\n</code> for centered breaks, or <code>\r</code> for right-justified breaks. If we were using a Graphviz <code>record</code> shape the line ending could be <code>|</code>. You have complete flexibility to insert any text at the point of a split in the text.</p></li></ul> <p>The label will be emitted to fit within the rectangle, as follows:</p> <p><code>&lt;&lt;b&gt;Deb Haaland&lt;/b&gt;&lt;BR/&gt;&lt;BR/&gt;Secretary of the&lt;BR/&gt;Interior&gt;</code></p> <h2 id="writing-the-node-query"><a href="#writing-the-node-query" class="header-anchor">#</a> Writing the Node Query</h2> <p>Our first query traverses the tree and writes the <code>Item</code> is related to <code>Related Item</code> edge relationships. We now repeat the query to traverse the tree a second time, but we will only output information specific to the nodes.</p> <p>The Node query is specified as:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
      <span class="token string">'SELECT [ID] AS [ID], 
              [ID] AS [ITEM], 
              ''&lt;&lt;b&gt;'' &amp; [Name] &amp; ''&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;'' &amp; [Title] &amp; ''&gt;'' AS [LABEL], 
              ''25''         AS [SPLIT LENGTH],
              ''&lt;BR/&gt;''      AS [LINE ENDING],
              ''Department'' AS [STYLE NAME]
       FROM   [US Executive Branch$] 
       WHERE  [Reports To ID] = ''{WHERE VALUE}'''</span> 
                    <span class="token keyword">AS</span> <span class="token punctuation">[</span>TREE QUERY<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'15'</span>  <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">VALUE</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'ID'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">COLUMN</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token number">2</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>MAX DEPTH<span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>ITEM<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'&lt;&lt;b&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Title<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&gt;'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>LABEL<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'25'</span>         <span class="token keyword">AS</span> <span class="token punctuation">[</span>SPLIT LENGTH<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'&lt;BR/&gt;'</span>      <span class="token keyword">AS</span> <span class="token punctuation">[</span>LINE ENDING<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'Department'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>STYLE NAME<span class="token punctuation">]</span>
<span class="token keyword">FROM</span>  <span class="token punctuation">[</span>US Executive Branch$<span class="token punctuation">]</span> 
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'15'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>where the label is specified as</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>              <span class="token string">''</span><span class="token operator">&lt;&lt;</span>b<span class="token operator">&gt;</span><span class="token string">''</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">''</span><span class="token operator">&lt;</span><span class="token operator">/</span>b<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token string">''</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Title<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">''</span><span class="token operator">&gt;</span><span class="token string">''</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>LABEL<span class="token punctuation">]</span><span class="token punctuation">,</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>to concatenate column values with literal strings to create the HTML-like label described above.</p> <p>The line splitting is specified as:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>              <span class="token string">''</span><span class="token number">25</span><span class="token string">''</span>         <span class="token keyword">AS</span> <span class="token punctuation">[</span>SPLIT LENGTH<span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token string">''</span><span class="token operator">&lt;</span>BR<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token string">''</span>      <span class="token keyword">AS</span> <span class="token punctuation">[</span>LINE ENDING<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The Node style is specified as:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>              <span class="token string">''</span>Department<span class="token string">''</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>STYLE NAME<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>One additional thing you <strong>must</strong> notice is that this syntax repeats as:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>      <span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>ITEM<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'&lt;&lt;b&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Title<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&gt;'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>LABEL<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'25'</span>         <span class="token keyword">AS</span> <span class="token punctuation">[</span>SPLIT LENGTH<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'&lt;BR/&gt;'</span>      <span class="token keyword">AS</span> <span class="token punctuation">[</span>LINE ENDING<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'Department'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>STYLE NAME<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The reason for this repeated syntax is related to the dual-query nature of a recursive tree query. At the beginning of this document, the concept of <em>Anchoring the Base Case</em> is discussed. This syntax outputs the node information for the base case (in this example, <code>ID = 25</code>). To create a complete organization chart, we must output the node information for the base case and for each branch of the tree as it is traversed.</p> <p><strong>Important:</strong> Pay very close attention to how literal strings are represented in the <em>Base Case</em> query, and the <em>Recursive Member Case</em> query to avoid SQL syntax errors.</p> <ul><li><p>The <em>Base Case</em> query uses 1 single quote to denote a string.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">'&lt;&lt;b&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Title<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&gt;'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>LABEL<span class="token punctuation">]</span><span class="token punctuation">,</span> 
<span class="token string">'25'</span>         <span class="token keyword">AS</span> <span class="token punctuation">[</span>SPLIT LENGTH<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>The <em>Recursive Member</em> query uses 2 single quotes to denote a string within the <code>TREE QUERY</code> string (i.e. strings within a string require 2 single quotes).</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token string">''</span><span class="token operator">&lt;&lt;</span>b<span class="token operator">&gt;</span><span class="token string">''</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">''</span><span class="token operator">&lt;</span><span class="token operator">/</span>b<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token string">''</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Title<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">''</span><span class="token operator">&gt;</span><span class="token string">''</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>LABEL<span class="token punctuation">]</span><span class="token punctuation">,</span> 
<span class="token string">''</span><span class="token number">25</span><span class="token string">''</span>         <span class="token keyword">AS</span> <span class="token punctuation">[</span>SPLIT LENGTH<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>When we run the query, the nodes are output as:</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAesAAABTCAYAAAC/HS8NAAAABmJLR0QA/wD/AP+gvaeTAAALGElEQVR4nO3dMWjbTBvA8aeh0KW8GEo2k6HUmzu1IUND6GIIGdpCCM3UgA2d4sWQIcRDB5sMgUAhUyGGbi6pl06m3UIob0kzFLwlZAghUEzApFOnfMOH/MqyTjrJkn2y/z8IbU6n00l6pEc62cqd29vbWwEAAKY6mBp1DwAAgDeSNQAAhiNZAwBgOJI1AACGu+tWmE6nZW5ubth9wZiYmpqSg4OD2NonPjEI4hMmU8Wna7Kem5uTWq0We6cwngqFQqztE58YBPEJk6niM1HD4KlUquen2WwGmi9oPd35Bl3uqNpDP2eMmbbNnf1aXV2VVqs11GVj9NrttlSr1e4+qVar0m63RSR5+ynM8XZ5eSl7e3tD6J05XO+sTdfpdOT4+FhyuZzU63VZXFwcdZcwJjqdjohI94Rh/W4aZz/r9foou4Mh297ellqtJqenpyIikslk5Pr6WnZ3d0fcs/CCHGvZbFZERNbX1+PqjnESdWdtNzs7KyIiX79+7SlvNBrdq7OPHz/2TGs2m5JKpaRUKnWvQoNot9tSKpX67mhU5Trz2kcJvNrVHUVAfOyx1Wg0uuX2uxtrHx4eHsrHjx+7v/vVsX6suGy32936Kjc3NyIiMj8/r+yndQz4xZ9zXZzzOOPPvj5WH6NaLvzZh9mnp6el0+n0JWq/c4ruechrmoj/caGaT8fZ2VnPCMLe3l5f3Lj1w4q/Qftu0uhaIu+s7Wq1WjdIG42GFAqFnqvNP3/+dOtms1lptVqSzWbl4cOHyqsy1Y7Z3t6Wzc1N2d3d7bmjUZXrzGt59OiRnJ6eSiaT6U779OmT1Gq1oQ1zQs2KraOjIxH5L0EuLy9367x+/VqKxaLMzMxIs9mUnz9/ysXFhczMzGjXOTk5kcXFRTk5ORERkZcvX7r2x4qhfD4vb9686eun8xg4Pz/3jVEnnfhbW1uTdDod6XLhr16vy+rqqhSLRVlZWZGFhQWZnp7uqeN2TglzHvKapnNceLVpZz/vWnfZ5XJZms2mXFxcyN+/fyWTycjGxobs7Oz01PM79wftu9Vuq9WS+fl52d/fd+3zMN1xe93o8vKykR+QcA5Nqn5X8Rvi9Gv/5uZGvn//LicnJz3Boiq3z69Tx7lMv/6YqlAoyOfPn2NrfxjxqRtrOvvJ7SSkqpPP52V3d1dKpZJcXV31ndjs87XbbclkMt15nMuyu7i4iDT+dI+9MMuN2zjEp8j/n9v++PFDDg4OpNlsypcvX2RhYcFz20Z9Hori/OW176vVareflUpF5ubmZHZ2NpJzv1//2u22FItFefz4sWxtbXm2HyVFfCb/daP5fL6vrNPp9PxE5d27d7K6uipra2ta5UHrANadbK1Wk5WVFc+61p2UW2JwHgPDir9RLXcSpdNpWV5e7l7QvXjxwneepO2Pra0tabVaUq/X5fz8XHK5nJRKJWX9KM/9Hz58EBGRt2/fDtROVBKbrI+Pj0VE5NWrV92y9+/fd6dZz/zsnxg8Pj6Wy8vLnrpBWCfFe/fuaZUHreNk9fHs7EzOzs4C9RXRsobBWq1Wd1g4rqExazgul8t51rOeWW9sbHTLVMeAKv6sD2e22+2+GAsSf1EuF/6s587tdrv7OQe3GxenMOchL3EfF9VqVbLZrDx58qQ7enR1ddVXz+/cH7TvjUZDdnZ2pFwu9z1eGJVEPrNOpVKyuLgo9XpdFhYWuuVra2ty//797kmuUqnI+vq6lMtlERG5vr6WXC4n+XxelpaWAi/36OhI5ufn5fDwUKs8aB2npaUl+fXrlzx9+pTnfCNmPYOzEun+/n7Pc7mo7O/vS6FQkEqlIv/884+ynn3Y3H7lrzoGnj9/7hp/1rGRyWT6YixI/EW5XPjb3NyUBw8edJ/BbmxsaN0BhjkPeYnyuHB7XFQsFiWdTvet5+/fv6VSqUgqlZJv3775nvuD9t36rrP9w5ujfvyYqGfWSIZxeSY4Cnt7e1Iul6XVakk6nR51d8YS8QmTje0za2AcWF8POT8/l6OjIxI1gB6JHAYHxs2oh9gAmI07awAADEeyBgDAcCRrAAAMR7IGAMBwJGsAAAxHsgYAwHAkawAADEeyBgDAcCRrAAAMR7IGAMBwJGsAAAxndLK2/8k0r7I4lxcnv/Ubdn8mgXObxrWNg7RLnBPnXqztE/V2GqQ91bzjEssmxqTRydqN/Q8eWH+pyO0EbC93C/Ywddzq6Zz8ddrxa9NvHRFOp9PR2rb2feOVaPxiyu13Vb+8+uNWTpxPFtX2dtvfzmlB4kAnhrwkLZbd6uvEddyM/qtb9hOp868SpVKpviCw6jvLnfV15lXVcZvmRdWOW19V/Xcu16sOBqO73722uds+8kKcE+dBqfa/W5lOfa9trRN/lnGIZXu7UbUZBaOTtUhvMNl/t5f5ze+2Uf3mdbvjcvbJ2X4cO0/VHnca8dHZ70HoxAhxTpy7cSZN50WQVe4WP846qmnO6YOalFge9oWj8cna4nY1M8jG8ptXdbVnCu4w4jPKbUuc9yLO/S8e3WLFLQl5TYsjDojlaBn9zDrIxlbV1WnDr47uFd2oTizjFpTD5LffnEOJfm2peMUIca5n0uLcfhdt/0mlep+fepXZ21JNc1vuIH0etO4kxHIYRt9ZuwWVc0hIp9ytDbd5RfqftanaCLsOOsHhF0Rh2sR/vLad17Z1ex7nFSe6JwPiPLo2J4Vq26hiQhUvg8SB6u496bGsu9xhMzpZi3hvHNU01fBP0DLnidqvP4P2U7VMnWnQo5s8g0yLIk6Ic71pk8Rve4bdt0HqquqEiVevaSbHsm5f4mb0MHhSJG04BcM3DjEyDusAiCQzlknWEUjaTkdwg+7jcYiRcVgHQCSZsTxxyTqKDy9ENQ/gRHzCi/Wc2f5jn+Y13zD65rdMVZlV7vehM1W9YcX3KI8j459ZJ0USr9QwOYjP8RHkswEm8fpu8yCf8UjikHYYE3dnbed2hep25eZ1FRu2PuCH+EQQfvvYXu7VhltshGlP5xPZ9gSu6otqPtW/w1zHYZr4O2u3KzT7lZrzqs1rWpj6gBfiE05+XyVy28fO8qCxoROHUdJt294Pr/6ryka5jkFNfLLW4XXlGAQnQsSB+JwsfvvJ+X1j1dCz13xh+uR3N2tPikEuDIP0y69enOsYN5K1Bk5iMBnxCacwoyWqO/Ik8VvXJK/jRD+zDiNJOxeTh/iEc5g8TEwEncfvubXbB8p0LyTCxrTO8/Io24sbd9YKViA5gz3oUBJ3PYgD8QkVt32sk2icw+dBhpSjHiIO07ZObJu0jkFNXLL2eo2c3yv2vMpMfD0dkof4hBev/aQTO37tuLWhG0tBv1Lmtyyv6UH7EGS5g7YfF4bBAQAwHMkaAADDTdwwOABgcM7nt2GGiPluvz6SNQAgFL+XkCA6DIMDACIX9LW2Oq9LnWTcWQMAIjXIa3B1Xhs6iUjWAIBQVN9r9vpOst/7ut1elwqSNQAgJFUiDfJaT7e3mYV5Xeq445k1ACA2g7zWc9RvDTMJd9YAgEiFfa1nmFfoTgqSNQAgMJ330Dv/n4TXepqKYXAAAAxHsgYAwHAkawAADEeyBgDAcCRrAAAMR7IGAMBwJGsAAAxHsgYAwHAkawAADEeyBgDAcCRrAAAMR7IGAMBwJGsAAAxHsgYAwHAkawAADEeyBgDAcCRrAAAMR7IGAMBwd90Kp6ampFAoDLsvGBPPnj2LtX3iE4MgPmEyVXzeub29vR1yXwAAgL4DhsEBADAcyRoAAMORrAEAMNxdETkYdScAAIDSv/8DPkMy0DL+fokAAAAASUVORK5CYII=" alt=""></p> <h3 id="combining-the-edges-and-nodes"><a href="#combining-the-edges-and-nodes" class="header-anchor">#</a> Combining the Edges and Nodes</h3> <p>Now it just a matter of running both SQL statements to combine the edges and nodes.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
  <span class="token string">'SELECT [ID], [Reports To ID] AS [ITEM],    [ID] AS [RELATED ITEM], 
                [Department]    AS [CLUSTER], ''Border 2 '' AS [CLUSTER STYLE NAME]
          FROM [US Executive Branch$] WHERE [Reports To ID] = ''{WHERE VALUE}'''</span> 
       <span class="token keyword">AS</span> <span class="token punctuation">[</span>TREE QUERY<span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token string">'15'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">VALUE</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token string">'ID'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">COLUMN</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">2</span>    <span class="token keyword">AS</span> <span class="token punctuation">[</span>MAX DEPTH<span class="token punctuation">]</span>

<span class="token keyword">SELECT</span> 
      <span class="token string">'SELECT [ID] AS [ID], 
              [ID] AS [ITEM], 
              ''&lt;&lt;b&gt;'' &amp; [Name] &amp; ''&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;'' &amp; [Title] &amp; ''&gt;'' AS [LABEL], 
              ''25''         AS [SPLIT LENGTH],
              ''&lt;BR/&gt;''      AS [LINE ENDING],
              ''Department'' AS [STYLE NAME]
       FROM   [US Executive Branch$] 
       WHERE  [Reports To ID] = ''{WHERE VALUE}'''</span> 
                    <span class="token keyword">AS</span> <span class="token punctuation">[</span>TREE QUERY<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'15'</span>  <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">VALUE</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'ID'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> <span class="token keyword">COLUMN</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token number">2</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>MAX DEPTH<span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>ITEM<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'&lt;&lt;b&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;'</span> <span class="token operator">&amp;</span> <span class="token punctuation">[</span>Title<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token string">'&gt;'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>LABEL<span class="token punctuation">]</span><span class="token punctuation">,</span> 
      <span class="token string">'25'</span>         <span class="token keyword">AS</span> <span class="token punctuation">[</span>SPLIT LENGTH<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'&lt;BR/&gt;'</span>      <span class="token keyword">AS</span> <span class="token punctuation">[</span>LINE ENDING<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'Department'</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>STYLE NAME<span class="token punctuation">]</span>
<span class="token keyword">FROM</span>  <span class="token punctuation">[</span>US Executive Branch$<span class="token punctuation">]</span> 
<span class="token keyword">WHERE</span> <span class="token punctuation">[</span>ID<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'15'</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>The organization chart for the <em>Department of the Interior</em> <code>ID=15</code> appears as:</p> <p><img src="data:image/png;base64,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WCoASwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrD0WNwF0NUr1z796LOuZ5+Ju5CI/fTvn4jo+J9Pxl1IxO7c/uHtsbdeef3leMuIP7hEdOL4iaNHj8ZdBRiZm5t7QPfjrqI9ghsJy7KUlkaj0eLjDgwMFAqF3t7eaAdvzTfCS3KCK17duF5p+eizs7MtPnoKJfyHs2q1almWZVnValW0iC+npqYsy8pms/Pz8zMzM+Kx3ybBtm0ism1b9HEf6969e0TU19fnPvrMzIzYd3x8XAxer9edYuTC5G61Ws0ZyqlNHDrcyEmSnBnXrVqt5vP5hYUF+l+eBgcHxaY33nhjbGxs7969tVrt5s2b6+vre/fu1W9aWVkZGBhYWVkhotdee005lkjG8PDwm2++KR99dXWViDKZzObm5q1btyYmJkqlkn5ivnTpUqVSEflT5HK57u7u0CMnSZKDm8/nichZcebzeSe4PT09Tjf5sWbT9evXBwYGxL/uVWyj0bBtO5PJEFGpVHKOLlqIqFAorK+vLy4uiujLs6miUCgQUXd3t3uTaAw9cpIkfKkQITELViqVoaEhzw6dnZ2im9zYkExOTmaz2VwuF0k9zRuZhSQHt1wuE1G9Xhcfu+LLnRDrjf7+fs+tYo176tQp8eX58+eJaHl5WSyLp6enRaY7OjqcXQYGBojItu21tTWnUey4trYmN8pCj5wkSV4qiIWBSFu5XHbWCeGUy+V8Pl8sFp966in3VmeNOzIyIlpyudyePXtEyovF4ujo6EsvvdTX1zc/P+/sJVYFmUxGXpUeOXLk22+/PXDggN9SNfTISbJra2vLvPfQ+8d+efjzxXeLEVZw9cq1jodPtv8FiOnp6UKhUK/XPVef6TE3N/dg9/1or5yNnC08vvuJy+99bL5LkpcKURGnk27durWwsJDy1LaPJC8VooILV20IMy6whOACSwgusITgAksILrCE4AJLCC6whOACSwgusITgAksILrDEL7jy7VM7v5Vq2xGUDpHcvNWM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" alt=""></p> <p>Running the queries starting with the <em>President of the United States</em> (<code>ID=1</code>) and <code>Max Depth = 1</code> shows the Presidents cabinet.</p> <p><img src="/assets/img/Example04-1-1.c6f66481.png" alt=""></p> <p>with <code>Max Depth = 2</code> we see the Secretaries and Deputy Secretaries</p> <p><img src="/assets/img/Example04-1-2.00180f9d.png" alt=""></p> <p>Specifying <code>Max Depth = 0</code> removes the depth limit, and we get the full organization chart.</p> <p><img src="/assets/img/Example04-1-0.18fdfc78.png" alt=""></p> <h2 id="sample-content"><a href="#sample-content" class="header-anchor">#</a> Sample Content</h2> <p>The files used in these examples are contained in the <code>\Relationship Visualizer\samples\13 - Using SQL - Organization Charts</code> directory in the zip file download.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5b85367f.js" defer></script><script src="/assets/js/6.56d8a82c.js" defer></script><script src="/assets/js/12.d313ae13.js" defer></script>
  </body>
</html>
